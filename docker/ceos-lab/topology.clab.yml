name: ceos-triangle

mgmt:
  network: custom-mgmt
  ipv4-subnet: 172.20.20.0/24

topology:
  nodes:
    ceos1:
      kind: ceos
      image: ceos-lab:4.35.1F
      mgmt-ipv4: 172.20.20.11
      startup-config: configs/ceos1.cfg
      env:
        INTFTYPE: eth
        ETBA: 1
        SKIP_REBOOT: 1
      binds:
        - ~/.ssh/ansible_id_rsa.pub:/home/admin/.ssh/authorized_keys

    ceos2:
      kind: ceos
      image: ceos-lab:4.35.1F
      mgmt-ipv4: 172.20.20.12
      startup-config: configs/ceos2.cfg
      env:
        INTFTYPE: eth
        ETBA: 1
        SKIP_REBOOT: 1
      binds:
        - ~/.ssh/ansible_id_rsa.pub:/home/admin/.ssh/authorized_keys

    ceos3:
      kind: ceos
      image: ceos-lab:4.35.1F
      mgmt-ipv4: 172.20.20.13
      startup-config: configs/ceos3.cfg
      env:
        INTFTYPE: eth
        ETBA: 1
        SKIP_REBOOT: 1
      binds:
        - ~/.ssh/ansible_id_rsa.pub:/home/admin/.ssh/authorized_keys

  links:
    # [삼각형 구조] 스위치 간 상호 연결 (Inter-switch Links)
    - endpoints: ["ceos1:eth1", "ceos2:eth1"]
    - endpoints: ["ceos2:eth2", "ceos3:eth1"]
    - endpoints: ["ceos3:eth2", "ceos1:eth2"]

    # [역할 분리] Ethernet3 추가 연결
    # ceos1, ceos2는 클라우드 이중화 Uplink (외부 브릿지 br-cloud에 연결 가정)
    - endpoints: ["ceos1:eth3", "bridge:br-cloud"]
    - endpoints: ["ceos2:eth3", "bridge:br-cloud"]
    
    # ceos3는 내부 네트워크 서비스 영역 (내부 브릿지 br-internal에 연결 가정)
    - endpoints: ["ceos3:eth3", "bridge:br-internal"]