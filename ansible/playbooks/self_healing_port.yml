---
- name: Automatic Port Recovery for Arista
  hosts: all  # Zabbix에서 전달하는 --limit {HOST.NAME}에 의해 해당 장비만 실행됨
  gather_facts: no
  connection: network_cli

  tasks:
    - name: Reset Ethernet1 to clear err-disable state
      arista.eos.eos_config:
        lines:
          - shutdown
          - no shutdown
        parents: interface Ethernet1
      register: recovery_result

    - name: Log recovery status
      ansible.builtin.debug:
        msg: "Port Ethernet1 on {{ inventory_hostname }} has been reset. Result: {{ recovery_result.updates }}"