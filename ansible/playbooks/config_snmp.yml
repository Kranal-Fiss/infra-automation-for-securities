---
- name: Configure SNMP Settings on Arista
  hosts: arista
  gather_facts: no
  connection: network_cli
  
  vars:
    ansible_network_os: arista.eos.eos
    ansible_user: admin
    ansible_password: admin
    ansible_become: yes
    ansible_become_method: enable
    # [핵심 1] SSH 키 확인 무시 (Paramiko용)
    ansible_ssh_common_args: '-o StrictHostKeyChecking=no'
    ansible_paramiko_host_key_checking: False 

  tasks:
    - name: Configure SNMP User (AuthPriv)
      arista.eos.eos_config:
        lines:
          - snmp-server user V3USER V3GROUP v3 auth sha admin123 priv aes admin123
        save_when: modified
      # [핵심 2] 요청하신 속도 조절
      throttle: 1