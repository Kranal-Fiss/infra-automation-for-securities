- name: 액션 생성 상세 결과 확인
      ansible.builtin.uri:
        url: "{{ zabbix_url }}/api_jsonrpc.php"
        method: POST
        body_format: json
        body:
          jsonrpc: "2.0"
          method: "action.create"
          params:
            name: "NextSec_Unified_Action" # 이름을 바꿔서 중복 회피
            eventsource: 0 # 트리거 기반 액션
            status: 0 # 활성화 상태
            filter:
              evaltype: 0
              conditions:
                - conditiontype: 5 # Trigger value = PROBLEM
                  operator: 0
                  value: "1"
            operations:
              - operationtype: 0
                opmessage:
                  default_msg: 1
                opmessage_grp:
                  - usrgrpid: "7" # Admin 그룹 ID (환경에 따라 다를 수 있음)
          auth: "{{ zabbix_token }}"
          id: 32
      register: action_debug_result

    - name: API 응답 출력
      ansible.builtin.debug:
        var: action_debug_result.json